# viチートシート

## viとは

- Linuxターミナル上で動作する標準的なエディタ
- 操作が独特でとっつきにくいが、サーバーを触る上でviを使ったファイル編集を避けて通ることは出来ない
- Emacs派とvi派で古くからエディタ戦争が行われている

***

## viの基本

1. viには「スクリーンモード」と「挿入モード」がある
2. 起動した時点では「スクリーンモード」になっている
3. 編集を行うには、`i`, `a` キー等で「挿入モード」に入らなければならない
4. 「挿入モード」で `Esc` キーを押すことで「スクリーンモード」に戻る

- スクリーンモード
    - ファイルの保存、終了、検索等のコマンド入力
    - カーソルの移動
    - 文字、行の削除
    - コピー＆ペースト
- 挿入モード
    - 文字の追記
    - **カーソルの移動も文字の削除もできない**

基本的に、スクリーンモードでカーソルを動かし、編集したい場所で `i` もしくは `a` キーを押して、文字を記入

その後、`Esc` でスクリーンモードに戻って、`:wq` コマンドで保存して終了することだけ覚えておけば何とかなる

とりあえず困ったら `Esc` でスクリーンモードに戻って、`:q!` コマンドで強制終了してしまえば良い

***

## vi起動コマンド

vi起動前のコンソールでのコマンド（ファイルを開くコマンド）

|コマンド|内容|
|:--|:--|
|`vi file`|ファイルを開く なければ新規作成する|
|`vi -R file`|ファイルを読み取り専用で開く|
|`vi + file`|ファイルの末尾行にカーソルを合わせて開く|
|`vi +n file`|カーソルを指定行(n)で開く|
|`vi +/pattern file`|カーソルをパターンの文字列の場所でファイルを開く|

***

## スクリーンモードでのコマンド

### カーソル移動
|コマンド|内容|
|:--|:--|
|`h`, `j`, `k`, `l`|左、下、上、右|
|`w`, `W`|単語ごとに前に進む|
|`b`, `B`|単語ごとに前に戻る|
|`(`, `)`|次の段落の先頭|
|`ENTER`|次の行の文字先頭|
|`0`|今いる行の先頭に移動|
|`$`|今いる行の末尾に移動|
|`H`|今見えている画面の最上|
|`M`|今見えている画面の真中|
|`L`|今見えている画面の最下|

### スクロール
|コマンド|内容|
|:--|:--|
|`Ctrl`+`F`|次のページヘスクロール|
|`Ctrl`+`B`|前のページヘスクロール|

### 検索
|コマンド|内容|
|:--|:--|
|`/` pattern|petternを検索|
|`?` pattern|petternを逆方向に検索|
|`n`|直前の検索を繰り返し|
|`/`|直前の検索を繰り返し|
|`?`|直前の検索を逆方向に繰り返し|

### 行移動
|コマンド|内容|
|:--|:--|
|`:` n|n番目の行へ移動する|
|`G`|ファイルの末行へ移動する|

### 編集
|コマンド|内容|
|:--|:--|
|`i`|カーソルの位置で編集開始|
|`a`|カーソルの次文字から編集開始|
|`o`|カーソルの次行に新しい行を作成|
|`O`|カーソルの前行に新しい行を追加|
|`cc`|一行消して編集|
|`x`|カーソルの位置の文字を削除|
|`X`|カーソルの前の位置の文字を削除|
|`dd`|1行削除|
|`yy`|1行コピー|
|`v`|今いる位置から選択を開始、カーソル移動でドラッグ選択|
|`p`|削除、コピーした文字列をペーストする|
|`.`|事前のコマンドを繰り返す|
|`u`|事前のコマンドを取り消す|
|`J`|次行とカレントの行を連結する|

### 終了
|コマンド|内容|
|:--|:--|
|`:w`|保存|
|`:wq`|保存して終了|
|`:q`|終了|
|`:q!`|保存せずに終了|

### インデント
|コマンド|内容|
|:--|:--|
|`>>`|行を右にインデントする
|`<<`|行を左にインデントする
|`Ctrl`+`t`|挿入モード時にインデントする|
|`Ctrl`+`d`|挿入モード時にインデントを解除する|
